syntax = "proto3";
package api;

import "github.com/gogo/protobuf/gogoproto/gogo.proto";

import "knowledgemap_backend/microservices/knowledgemap/user/api/user.proto";



// message Empty{}


service Passport {
    rpc Register(RegisterReq) returns (PassportUserReply) {}
	rpc Login(LoginReq) returns (PassportUserReply) {}
    rpc CheckSToken(SessionTokenReq) returns (Empty) {}
    rpc ChangePassword(ChangePasswordReq) returns (Empty) {}
    rpc CheckIndentify(UserReq) returns (IndentifyReply){}
}


message SessionTokenReq {
    string uid = 1;
    string stoken = 2;
}

message PassportUserReply {
    UserReply user =  1;
    string token = 2;
    int64 expires = 3;
}

message RegisterReq {
    enum RegisterType{
        STUDENT = 0;
        TEACHER = 1;
        SECRETARY = 2;
    }
    RegisterType rtype = 1 [(gogoproto.moretags) = "form:\"rtype\""];
    string  name = 2 [(gogoproto.moretags) = "form:\"name\""];
    string  major = 3 [(gogoproto.moretags) = "form:\"major\""];
    string  idcard = 4 [(gogoproto.moretags) = "form:\"idcard\""];
    string  origin = 5 [(gogoproto.moretags) = "form:\"origin\""];
    string  class = 6 [(gogoproto.moretags) = "form:\"class\""];
    string admissontime = 7 [(gogoproto.moretags) = "form:\"admissontime\""];
    string  account =8 [(gogoproto.moretags) = "form:\"account\""];
    string password= 9 [(gogoproto.moretags) = "form:\"password\""];
    string college =10 [(gogoproto.moretags) = "form:\"college\""];
    string course =11 [(gogoproto.moretags) = "form:\"course\""];
}

message LoginReq{
    enum LoginType{
        STUDENT = 0;
        TEACHER = 1;
        SECRETARY = 2;
        NOTFOUND = -1;
    }
    LoginType ltype = 1 [(gogoproto.moretags) = "form:\"ltype\""];
    string  account = 2 [(gogoproto.moretags) = "form:\"account\""];
    string  password = 3 [(gogoproto.moretags) = "form:\"password\""];
}

message ChangePasswordReq{
    string  account = 1 [(gogoproto.moretags) = "form:\"account\""];
    string  password = 2 [(gogoproto.moretags) = "form:\"password\""];
}

enum Indentify{
    STUDENT = 0;
    TEACHER = 1;
    SECRETARY = 2;
    NOTFOUND = -1;
}

message IndentifyReply{
    Indentify ltype = 1 [(gogoproto.moretags) = "form:\"ltype\""];
}